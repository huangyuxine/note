# JWT

### 是什么 <a href="#shi-shen-me" id="shi-shen-me"></a>

JSON Web Token， 官方定义为：在双方之间传输信息的安全方式的 JSON 对象

### 特点

* 可以在 URL、POST 参数或 HTTP 标头中传递
* 携带交换信息和身份验证所需的所有信息

### 解决了什么问题

可以在有效负载中包含用户信息，并且可以在会话中用于对用户进行身份验证。通过身份验证后，用户可以使用请求中包含的 JWT 访问应用程序中受保护的资源。因此，每个请求都将通过验证 JWT 进行身份验证。

### 组成部分

JWT 包含三个部分：标头、有效负载和签名，它们由一个点分隔。

```
Header.Payload.Signatur
```

#### Header

令牌类型

对令牌进行签名算法

```
{  
 "typ" : "JWT",  
 "alg" : "HS256"  
}
```

算法类型：

* 对称算法：此算法类型使用单个密钥对 JWT令牌进行签名和验证。例如：HMAC 算法。
* 非对称算法：此算法类型使用私钥对令牌进行签名，并使用公钥来验证签名。例如：RSA 和 ECDSA 算法。

#### Payload

有效载荷（也称为 JWT 声明）包含我们要传输的所有信息。可以使用不同类型的声明来构建有效负载，参数可选

| 参数      | 说明                               |
| ------- | -------------------------------- |
| **iss** | jwt签发者                           |
| **sub** | jwt所面向的用户                        |
| **aud** | 接收jwt的一方                         |
| **exp** | jwt的过期时间，这个过期时间必须要大于签发时间         |
| **nbf** | 定义在什么时间之前，该jwt都是不可用的             |
| **iat** | jwt的签发时间                         |
| **jti** | jwt的唯一身份标识，主要用来作为一次性token，防止重放攻击 |

有效负载示例：

```
{  
 "sub": "123",  
 "name": "huangyuxin",  
 "exp": 1731195630  
}
```

#### Signatur

签名需要：

* Header
* Payload
* 用于对标头和有效负载进行签名的算法
*   密钥（服务器端指定）

    HMACSHA256(\
    base64UrlEncode(header) + "." +\
    base64UrlEncode(payload),\
    secret)

### 优点

扩展性、可用性高，特别是在分布式应用中

不用存储令牌状态（这一点既是优点也是缺点）

### 缺点

当令牌后端在有效期内丢弃一个令牌或更改其权限时，它不会立即生效，一般来说需要等到到期日期

无法强制让令牌失效（对于jwt本身来说）
